<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Log In</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <nav><%- include('navbar', {links: links}) %></nav>
  <% if (locals.user && user.isadmin && user.ismember) {%>
    <h1>WELCOME BACK, <%= user.fullname %></h1>
    <a href="/log-out">LOG OUT</a>
    <br></br>
    <a href="/post">Post a message</a>
    <br></br>
    <div class="indexcontainer">
    <% messages.forEach((message, index) => { %>
    <div class="indexcard">
      <div class="msgcontainer">
        <p><%= message.title %></p>
        <p>Msg #: <%= message.id %></p>
        <p><%= message.body %></p>
      </div>
      <div class="namecontainer">
        <h4><b><%= message.username %></b></h4>
        <p><%= message.posted.toLocaleString() %></p>
      </div>
      <form action="/delete/<%= message.id %>" method="POST" style="display:inline;">
        <button class="btn" type="submit" onclick="return confirm('Are you sure you want to delete this message?');">Delete</button>
      </form>
    </div>
    <% }) %>
    </div>
  
  <% } else if (locals.user && user.ismember) {%>
    <h1>WELCOME BACK, <%= user.fullname %></h1>
    <a href="/log-out">LOG OUT</a>
    <br></br>
    <a href="/post">Post a message</a>
    <br></br>
    <div class="indexcontainer">
    <% messages.forEach((message, index) => { %>
    <div class="indexcard">
      <div class="msgcontainer">
        <p><%= message.title %></p>
        <p>Msg #: <%= message.id %></p>
        <p><%= message.body %></p>
      </div>
      <div class="namecontainer">
        <h4><b><%= message.username %></b></h4>
        <p><%= message.posted.toLocaleString() %></p>
      </div>
    </div>
        <% }) %>
    </div>

    <% } else if (locals.user) {%>
    <h1>WELCOME BACK, <%= user.fullname %></h1>
    <h3>Join the club to see posts</h3>


  <% } else { %>
    <h1>Please log in</h1>
    <form action="/log-in" method="POST">
      <label for="username">Username</label>
      <input id="username" name="username" placeholder="username" type="text" />
      <label for="password">Password</label>
      <input id="password" name="password" type="password" />
      <button type="submit">Log In</button>
    </form>
    <br></br>
    <div class="indexcontainer">
    <% messages.forEach((message, index) => { %>
    <div class="indexcard">
      <div class="msgcontainer">
        <p><%= message.title %></p>
        <p><%= message.body %></p>
      </div>
      <div class="namecontainer">
        <h4><b>(Log in to see author and date)</b></h4>
      </div>
    </div>
    <% }) %>
    </div>


  <%}%>
</body>
</html>